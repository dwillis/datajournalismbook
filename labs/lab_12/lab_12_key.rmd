---
title: "lab_12"
author: "derek willis"
date: "8/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## You will need

* A Census API key

## Load libraries and establish settings

**Task** Create a codeblock and load appropriate packages and settings for this lab.

```{r}
# Turn off scientific notation
options(scipen=999)

# Load the tidyverse.
library(tidyverse)
library(tidycensus)
library(lubridate)
library(janitor)
library(sf)
library(tigris)

# Establish API Key for Census
census_api_key("549950d36c22ff16455fe196bbbd01d63cfbe6cf")

```

## Questions

**Q1.** You are interested in tracking vaccinations by age group, and in particular how many children are being vaccinated over time. You want to generate a sentence that describes the daily change in vaccinations among children between 5-11 years old, and also compares it to the most recent same day of the week.

Using [CSV data posted by the state](https://raw.githubusercontent.com/state-of-maryland/VaccineCSVs/master/MD_COVID19_VaccinationPercentAgeGroupPopulation.csv), making the column names more readable and ensuring each day is formatted as a date column that only contains the date, not a time.

Then write code that will construct the sentence about the data described above comparing the most recent data to the previous date and the most recent date for the same day of the week. To do that, you will need:

1. A dataframe with vaccination data for the under-12 age group.
2. A column in your dataframe that contains the day of the week that each date represents (you may need to google how to do that).
3. Data from the previous day and the most recent same day of the week.
3. A template for your sentence.

In addition, draw a line chart using ggplot showing the number of first-dose vaccinations by date for the under-12 age group. Add points for each date and label them with the number of first-dose vaccinations. Write a sentence describing what you see on the chart. What story does it tell?

**A1.** 

```{r}

# Read in a table of daily vaccination totals by age group and clean the column names

vaccinations_by_age <- read_csv("https://raw.githubusercontent.com/state-of-maryland/VaccineCSVs/master/MD_COVID19_VaccinationPercentAgeGroupPopulation.csv") %>% clean_names()

vaccinations_by_age <- vaccinations_by_age %>%
  mutate(vaccination_date = date(mdy_hms(vaccination_date)))

# Create a dataframe that stores the first 15 days of data for under_12s

under_12 <- vaccinations_by_age %>%
  filter(age_range == '11 and Under') %>%
  arrange(vaccination_date)

under_12 <- under_12 %>%
  mutate(day_of_week = weekdays(vaccination_date))

previous_day <- under_12


under_12 %>%
  ggplot() +
  geom_line(aes(x=vaccination_date, y=first_daily_dose)) +
  geom_point(aes(x=vaccination_date, y=first_daily_dose)) +
  geom_text(aes(x=vaccination_date, y=first_daily_dose, label=first_daily_dose), hjust=1)


```

**Q2.** How does Prince George's County fare in vaccinating 5-11 year-olds compared to Montgomery County? Create a chart showing the daily difference between the two counties, and provide automated labels and text describing the latest date's difference. 

**A2.** 

```{r}

```

**Q3.** 

**A3.**

```{r}

```
**Q4.** 

**A4.**

```{r}

```
