---
title: "lab_06"
author: "derek willis"
date: "8/25/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## You will need

* Tabula
* The [Atom](https://atom.io/) text editor.

## Load libraries and establish settings
```{r}
# Turn off scientific notation
options(scipen=999)

# Load the tidyverse. If you have not installed the tidyverse already, remove the # from the next line and run it first.  
# install.packages('tidyverse')
library(tidyverse)
```

## Get Our PDF

We'll be working with the [Maryland Statistical Handbook](https://planning.maryland.gov/MSDC/Documents/md-statistical-handbook.pdf) from the state Department of Planning. It's not tiny (44MB), and you'll want to download it to a place you'll remember (like your Downloads folder).

## Setup Tabula

Start Tabula, then go to http://127.0.0.1:8080/ in your browser. Click the "Browse" button and find the Statistical Handbook file and click "open", and then click the "Import button" in Tabula. This will take a minute or two.

Let's go to page 30 of the PDF, Table 2A, "International Migration for Maryland's Jurisdictions, July 1, 2010 to July 1, 2019". In Tabula, draw a box around that table's border and click the "Preview & Export Extracted Data" button. It should look pretty clean. Let's export that CSV (it should be called `tabula-md-statistical-handbook.csv` by default) to your Downloads folder.

## Cleaning up the data in R

Let's load it into R, and in doing so we'll skip the first two rows and add our own headers that are cleaner:

```{r}
international_migration <- read_csv('tabula-md-statistical-handbook.csv', skip=2, col_names=c("jurisdiction", "july_2011", "july_2012", "july_2013", "july_2014", "july_2015", "july_2016", "july_2017", "july_2018", "july_2019", "total"))
```

Add a column for the type of migration ("international") and populate it:

```{r}
international_migration <- international_migration %>% mutate(type='international')
```

## Answer questions

Q1. Which jurisdiction had the largest percentage change between 2011 and 2019? You'll need to add and populate a `pct_change` column using `mutate`.
A1.

```{r}
international_migration %>%
  mutate(pct_change=(july_2019-july_2011)/july_2011) %>%
  select(jurisdiction, pct_change) %>%
  arrange(desc(pct_change))
```
